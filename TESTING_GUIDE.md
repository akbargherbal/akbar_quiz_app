# Testing Guide for the Django Project

This guide provides clear instructions on how to run tests for this Django project and locate the relevant log files.

## Log File Structure

Test logs are now organized by application to prevent conflicts. All logs for a specific app will be found within a subdirectory named after the app inside `src/logs/`.

**Structure:**

```
src/
├── logs/
│   ├── multi_choice_quiz/
│   │   ├── django_tests.log      # Overall log from running 'manage.py test' (if runner configured this way)
│   │   ├── test_models.log
│   │   ├── test_views.log
│   │   ├── playwright_tests.log
│   │   └── ... other multi_choice_quiz logs ...
│   └── pages/
│       ├── test_views.log        # Example for pages app
│       └── ... other pages logs ...
└── ... other project files ...
```

## Types of Tests

The project uses two main testing approaches:

1.  **Django Backend Tests**: Tests for models, views, utilities, etc., using Django's test framework.
2.  **Playwright E2E Tests**: End-to-end browser tests simulating user interaction with the frontend.

## Running Backend Tests (Django)

We use Django's built-in test runner.

### Prerequisites

1.  Ensure you have a virtual environment set up and activated.
2.  Make sure you're in the `src` directory (containing `manage.py`).

### Running All Backend Tests

To run all backend tests discovered in the project:

```bash
python manage.py test
```

This will:

- Run tests for all apps.
- Display results in the terminal.
- Generate/overwrite an overall log file (e.g., `src/logs/multi_choice_quiz/django_tests.log` based on the current `TEST_RUNNER` setting in `settings.py`).
- Generate/overwrite detailed log files within each app's log directory (e.g., `src/logs/multi_choice_quiz/test_models.log`, `src/logs/pages/test_views.log`).

### Running Backend Tests for a Specific App

To run tests only for a specific application (recommended for faster feedback during development):

```bash
# Example for multi_choice_quiz app
python manage.py test multi_choice_quiz

# Example for pages app
python manage.py test pages
```

This will only execute tests within the specified app and update logs within `src/logs/<app_name>/`.

### Targeting Specific Test Files/Classes/Methods

You can further target specific tests:

```bash
# Run tests for a specific file within an app
python manage.py test multi_choice_quiz.tests.test_models

# Run a specific test class
python manage.py test multi_choice_quiz.tests.test_models.QuizModelTests

# Run a specific test method
python manage.py test multi_choice_quiz.tests.test_models.QuizModelTests.test_quiz_creation
```

### Viewing Backend Test Results & Logs

1.  **Terminal Output**: The most immediate way to see if tests passed (`OK`) or failed (`FAILURES`/`ERRORS`).
2.  **Log Files**: For detailed inspection:
    - Check the overall log generated by the test runner (location depends on `TEST_RUNNER` setting, currently `src/logs/multi_choice_quiz/django_tests.log`).
    - Check the specific log files within the app's directory: `src/logs/<app_name>/`. For example:
      - `src/logs/multi_choice_quiz/test_models.log`
      - `src/logs/multi_choice_quiz/test_utils.log`
      - (If tests exist for `pages`) `src/logs/pages/test_views.log`

## Running End-to-End (E2E) Tests (Playwright)

The project includes Playwright E2E tests for testing frontend interactions. Each app with E2E tests will have its own dedicated runner script.

### Prerequisites

1.  Install testing requirements:
    ```bash
    pip install -r test_requirements.txt
    playwright install
    ```
2.  The Django development server must be running:
    ```bash
    python manage.py runserver
    ```
    _(Note: The E2E runner scripts typically check and start the server if it's not running)._

### Running E2E Tests for a Specific App

Use the app-specific runner script located in the `src` directory.

```bash
# Example for multi_choice_quiz app (after renaming the script)
python run_multi_choice_quiz_e2e_tests.py

# Example for a hypothetical 'pages' app E2E test runner
# python run_pages_e2e_tests.py
```

This will:

- Run the specific Playwright tests for that app against the running Django server.
- Display results in the terminal (`pytest` output).
- Generate/overwrite log files within the app's log directory (e.g., `src/logs/multi_choice_quiz/playwright_tests.log`, `src/logs/multi_choice_quiz/playwright_new_ui.log`).

## Understanding Test Output

When tests run successfully, you'll see output indicating `OK` (for Django tests) or `PASSED` (for pytest/Playwright tests).

Key things to look for:

- A dot `.` for each passing Django test.
- `OK` at the end shows all Django tests passed.
- `PASSED` indicates passing pytest tests.
- `FAILED` or `ERRORS` appear if tests fail, with details of what went wrong.

## Troubleshooting

If you encounter test failures:

1.  **Read Error Messages:** Carefully check the error messages and tracebacks printed in the terminal.
2.  **Check Logs:** Examine the relevant log files for detailed information:
    - For backend failures, check the overall runner log and the specific file logs within `src/logs/<app_name>/` (e.g., `test_models.log`).
    - For E2E failures, check the specific Playwright log files within `src/logs/<app_name>/` (e.g., `playwright_tests.log`).
3.  **E2E Specifics:**
    - Ensure the Django server (`python manage.py runserver`) is running or that the runner script successfully started it.
    - Check the E2E logs for details (`src/logs/<app_name>/playwright_...log`).
    - Check for screenshots saved on failure, which should also be located in `src/logs/<app_name>/` (e.g., `test_failure_YYYYMMDD_HHMMSS.png`).
    - Verify that any necessary sample data for the app being tested has been loaded.
4.  **Fix and Rerun:** Address the issues in your code and run the specific failing tests again.
